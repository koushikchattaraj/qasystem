{% extends 'base.html' %}
{% load static %}
{% block content %}

   <div class="signup-page">
    <div class="row">
      <div class="col-md-6">
        <div class="sing-up-heading ">
          <div class="subdomain">
            <div class="">
              {% if messages %}
              {% for message in messages %}
                  <div class="alert alert-success alert-dismissible fade show">
                      <strong>Success!</strong> {{message}}
                      <button type="button" class="close" data-dismiss="alert">&times;</button>
                  </div>
              {% endfor %}
          {% endif %}
            <!-- <div style="display: none;" class="alert alert-primary alert-dismissible fade show flash_cam_error success_edit_profile" role="alert">
                <div class="">
                  <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/></svg>
                  <strong>Incorrect Password Or Email! </strong> 
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div> -->

                  <h1 class="sign_up_h1 text-center animate__animated animate__fadeInUp">Sign In</h1>
                  <div class="pb-info">
                        <div class="form-group  animate__animated animate__fadeInUp">
                           
                              <label for="email">Email *</label>
                              <input type="email" name="email" class="form-control" id="email_id"  data-rule="email" data-msg="Please enter a valid email" required=""> 
                          
                            <div class="validation"></div>
                        </div>
                        <div class="form-group  animate__animated animate__fadeInUp">
                          <label for="password">Password *</label>
                         
                            <input type="password" name="password" class="form-control" id="password"  data-rule="password" data-msg="Please enter a valid password" required=""> 
                         
                          <div class="validation"></div>
                          <div class="form-signin-group checkbox mt-2">
                            <div class="form-radion2"> <a data-toggle="modal" data-target="#forgot_password" href="javascript:void(0)">Forgot your password?</a> </div>
                          </div>
                        </div>
                        <div class="text-center c-signup  animate__animated animate__fadeInUp">
                            <button type="submit" name="submit" id="btn_signin" class="red-theme-btn">Sign IN</button>
                        </div>
                        <div class="card-sec  animate__animated animate__fadeInUp">
                             <p class=""> Not registered yet? &nbsp;<a href="{% url 'accounts:sign_up' %}" class="create_account_link">  Create Account</a></p>
                        </div>
                  </div>
                </div>
          </div>
      </div>
    </div>
    <div class="col-md-6 align-self-center">
      <div class="signup_img">
        <img src="{% static '/images/signin.jpg' %}" alt="">
      </div>
    </div>
  </div>
  </div>


   <div class="modal fade" id="forgot_password" tabindex="-1" role="dialog" aria-labelledby="forgot_password">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="cli-ent-model-box">
        <div class="cli-ent-model">
          <header class="fo-rm-header animate__animated animate__fadeInUp">
            <h2 class="text-center">Forgot your Password?</h2>
            <p class="sub-title">Enter your email address and we'll send you a link to reset your password.</p>
          </header>
          <div class="confirmation_btn text-center">
            <form action="https://design.brandswaggin.com/welcome/forgot_password" method="post">
              <div class="  animate__animated animate__fadeInUp">
                <input class="form-control input-c" type="email" placeholder="Email Address" name="email" id="email" value="">
                <input class="form-control input-c" type="hidden" name="fromdomain" id="fromdomain" value="1"> </div>
              <div class="  animate__animated animate__fadeInUp">
                <button class="red-theme-btn" type="submit">Send Link</button>
                <p>Not a member? <strong><a href="{% url 'accounts:sign_up' %}" rel="canonical" class="create_account_link">Sign up!</a></strong></p>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<script type="text/javascript">
$('#popup_msg').hide();
function getCookie(name) {
              var cookieValue = null;
              if (document.cookie && document.cookie != '') {
                  var cookies = document.cookie.split(';');
                  for (var i = 0; i < cookies.length; i++) {
                      var cookie = cookies[i].trim();
                      // Does this cookie string begin with the name we want?
                      if (cookie.substring(0, name.length + 1) == (name + '=')) {
                          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                          break;
                      }
                  }
              }
              return cookieValue;
            }
  token = localStorage.getItem('token')

      if (token){
        window.location.replace('/');
     }
     else {
      
     } 


  $('#btn_signin').click(function(){
    

  const logindetail = {
    email:$('#email_id').val(),
    password:$('#password').val()
  }
  console.log(logindetail);
  const csrftoken = getCookie('csrftoken');
  console.log(csrftoken)
  const headers = {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken,
                  }
    

  axios
  .post("/api/login/", logindetail,{
    headers: headers
  })
  .then((res) => {

    localStorage.setItem("token",`Bearer ${res.data['token']}`);
    window.location.replace("/account");
    console.log("Post successful!");
  })
  .catch((res) => {
    // $('#popup_msg').show();
    console.log(res);
    console.log("Oops, request failed!")
    // console.log(res.error)
    $('.success_edit_profile').show();
  }) 

  });
 
                  
</script>

{% endblock %}


